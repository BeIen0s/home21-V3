<!DOCTYPE html>
<html>
<head>
    <title>Fix Auth Session</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Fix Auth Session</h1>
    <div id="status">Loading...</div>
    <button id="signOutBtn">Sign Out & Clear Session</button>
    <button id="checkSessionBtn">Check Current Session</button>

    <script>
        const supabaseUrl = 'https://msxqhbeqzfakzfkhwpzw.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1zeHFoYmVxemZha3pma2h3cHp3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg1MzM0MzgsImV4cCI6MjA3NDEwOTQzOH0.RBRUlobe5XOaWPc0_VBuqlNSJdisXAB9ZxV7JDHkzF4';
        
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        const statusDiv = document.getElementById('status');
        const signOutBtn = document.getElementById('signOutBtn');
        const checkSessionBtn = document.getElementById('checkSessionBtn');

        async function checkSession() {
            try {
                const { data: { session }, error } = await supabase.auth.getSession();
                
                if (error) {
                    statusDiv.innerHTML = `Error: ${error.message}`;
                    return;
                }

                if (session) {
                    statusDiv.innerHTML = `
                        <p><strong>Current Session:</strong></p>
                        <p>User ID: ${session.user.id}</p>
                        <p>Email: ${session.user.email}</p>
                        <p>Expires: ${new Date(session.expires_at * 1000).toLocaleString()}</p>
                    `;
                } else {
                    statusDiv.innerHTML = '<p>No active session</p>';
                }
            } catch (err) {
                statusDiv.innerHTML = `Error: ${err.message}`;
            }
        }

        async function signOut() {
            try {
                statusDiv.innerHTML = 'Signing out...';
                
                const { error } = await supabase.auth.signOut();
                
                if (error) {
                    statusDiv.innerHTML = `Sign out error: ${error.message}`;
                } else {
                    statusDiv.innerHTML = '<p style="color: green;">Successfully signed out! You can now close this page and try logging in again.</p>';
                }
            } catch (err) {
                statusDiv.innerHTML = `Error: ${err.message}`;
            }
        }

        signOutBtn.addEventListener('click', signOut);
        checkSessionBtn.addEventListener('click', checkSession);

        // Check session on load
        checkSession();
    </script>
</body>
</html>